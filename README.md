# 競艇スクレイピングアプリ

競艇の出走情報をスクレイピングするTauriアプリケーションです。フロントエンドにReact + TypeScript、バックエンドにRustを使用しています。

## 現在の機能

### 📊 データ取得機能
- **競艇日和サイト**からレース統計データを取得
- 指定した日付・レース番号・競艇場の情報を自動取得
- HTMLファイルの自動保存（`bort-html/`ディレクトリ）

### 📈 取得可能なデータ

#### 選手基本情報（1号艇のみ）
- 選手名、登録番号、級別、期別、支部、性別

#### 統計データ
- **逃げ率・逃がし率**: 1年間・半年間
- **差され率・捲られ率**: 1年間・半年間
- **直近成績**: 直近10レースでの1着回数

#### 詳細成績データ
- **1着率・2連対率・3連対率**: 今期、直近6ヶ月/3ヶ月/1ヶ月、当地、一般戦別

#### ST関連データ
- **平均ST・ST順位**: 今期、直近6ヶ月/3ヶ月、当地、一般戦、ナイター別
- **ST考察**: 安定率、抜出率、出遅率

#### 決まり手データ（直近6ヶ月）
- **1号艇**: 逃げ率、差され率、捲られ率
- **2号艇以降**: 差し率、逃し率

#### オッズデータ
- **三連単オッズ**: 人気上位・穴馬上位・1号艇関連組み合わせ
- **単勝・複勝オッズ**: 艇番別

### 🖥️ ユーザーインターフェース
- 日付選択
- レース番号選択（1〜12レース）
- 競艇場選択（全24場対応）
- リアルタイム結果表示
- 統計データの見やすい表形式表示

## 技術スタック

### フロントエンド
- **React + TypeScript**: UIコンポーネント
- **Tauri API**: Rustバックエンドとの通信
- **Vite**: バンドラー

### バックエンド（Rust）
- **headless_chrome**: ブラウザ自動化とスクレイピング
- **scraper**: HTMLパースとDOM操作
- **Tauri**: アプリケーションフレームワーク
- **serde**: データシリアライゼーション

## 開発コマンド

```bash
# フロントエンド開発
pnpm dev              # 開発サーバー起動
pnpm build           # プロダクションビルド
pnpm preview         # ビルドプレビュー

# Tauriアプリケーション
pnpm tauri dev       # アプリケーション開発モード
pnpm tauri build     # アプリケーションビルド

# テスト
cd src-tauri && cargo test  # Rustテスト実行
```

## アーキテクチャ

### メインコンポーネント
- **lib.rs**: Tauriコマンドの定義
- **headress.rs**: headless_chromeを使用したスクレイピング
- **parse/biyori/flame.rs**: 競艇日和のHTMLパース機能
- **information.ts**: 競艇場情報管理

### データフロー
1. フロントエンドから日付・レース番号・競艇場番号を送信
2. Rustバックエンドがheadless_chromeでサイトアクセス
3. HTMLを取得・パース
4. 統計データを構造化してフロントエンドに返却

## 現在の制限事項・未実装機能

### データの制限
- **1号艇のみの情報**: 全6艇中1号艇の選手情報のみ（2〜6号艇のデータ取得不可）
- **限定的な統計期間**: 直近10レースの1着回数のみ（より詳細な成績履歴・月別年別推移等は未対応）

### オッズ機能の制約
- **限定的なオッズタイプ**: 三連単・単勝・複勝のみ（二連単・二連複・拡連複等は未対応）
- **オッズ分析機能なし**: 期待値計算・回収率シミュレーション・人気と実績の乖離分析等

### レース情報の不足
- **レース条件情報なし**: 天候・風速・水面状況・進入コース予想・モーター/ボート情報
- **過去レース結果なし**: 同条件での過去成績・対戦相手との相性・会場別成績詳細

### UI・UX機能
- **データ保存・比較機能なし**: お気に入り選手登録・過去取得データの保存・複数レースの比較表示
- **リアルタイム機能なし**: オッズ変動追跡・レース結果自動取得・通知機能

### システム機能
- **バッチ処理なし**: 複数レース一括取得・日程全体のデータ収集・自動スクレイピング
- **エラー処理・復旧機能の不足**: ネットワークエラー時の再試行・データ取得失敗時のフォールバック・取得済みデータのキャッシュ機能

## 将来の拡張予定

- 全艇番（2〜6号艇）の選手情報対応
- 他の賭け式（二連単・二連複・拡連複）への対応
- レース条件情報（天候・水面状況等）の取得
- データ永続化・比較機能
- オッズ分析・期待値計算機能
- バッチ処理・自動スクレイピング機能
- リアルタイムオッズ変動追跡

## 開発環境セットアップ

### 推奨IDE
- [VS Code](https://code.visualstudio.com/) + [Tauri](https://marketplace.visualstudio.com/items?itemName=tauri-apps.tauri-vscode) + [rust-analyzer](https://marketplace.visualstudio.com/items?itemName=rust-lang.rust-analyzer)

### 必要な依存関係
- Node.js (pnpm使用)
- Rust
- Chrome/Chromium（headless_chrome用）
